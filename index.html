<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Safety & Tech Wheel</title>

<style>

/* ---------- GLOBAL THEME ---------- */
:root {
  --bg: #0d1117;
  --accent: #00b4ff;
  --accent2: #ff4da6;
  --glass: rgba(255,255,255,0.08);
  --radius: 14px;
  --text: #e6e6e6;
}

body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: "Segoe UI", sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  overflow: hidden;
  height: 100vh;
}

/* ---------- WINNER BANNER ---------- */
#winnerBanner {
  margin-top: 10px;
  padding: 15px 25px;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  border-radius: var(--radius);
  font-size: 26px;
  font-weight: bold;
  color: white;
  box-shadow: 0 0 18px rgba(0,0,0,0.5);
  min-height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ---------- CONTROLS ---------- */
.controls {
  margin-top: 10px;
  display: flex;
  gap: 12px;
}

.btn {
  padding: 10px 18px;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  border: none;
  border-radius: var(--radius);
  color: white;
  cursor: pointer;
  font-size: 15px;
  transition: 0.25s;
}

.btn:hover {
  transform: scale(1.05);
}

.reset-btn {
  background: #ff3333 !important;
}

/* ---------- WHEEL ---------- */
#wheelContainer {
  position: relative;
  margin-top: 20px;
}

#pointer {
  width: 0;
  height: 0;
  border-left: 22px solid transparent;
  border-right: 22px solid transparent;
  border-bottom: 35px solid var(--accent2);
  margin: 0 auto;
  animation: pulse 1s infinite alternate;
}

@keyframes pulse {
  from { transform: translateY(0); }
  to { transform: translateY(-4px); }
}

#wheel {
  margin-top: 10px;
  width: 420px;
  height: 420px;
  border-radius: 50%;
  border: 6px solid rgba(255,255,255,0.15);
  overflow: hidden;
  position: relative;
  transition: transform 6s cubic-bezier(.1, .9, .1, 1);
  box-shadow: 0 0 25px rgba(0,0,0,0.5);
}

.sliceLabel {
  position: absolute;
  left: 50%;
  top: 50%;
  width: 50%;
  transform-origin: 0% 50%;
  text-align: right;
  padding-right: 10px;
  color: white;
  font-size: 16px;
  font-weight: bold;
}

/* ---------- SIDE PANELS ---------- */
.sidePanelContainer {
  position: absolute;
  top: 70px;
  width: 95%;
  display: flex;
  justify-content: space-between;
  padding: 0 20px;
}

.panel {
  width: 180px;
  height: 300px;
  background: var(--glass);
  backdrop-filter: blur(14px);
  border-radius: var(--radius);
  padding: 10px;
  overflow-y: auto;
  font-size: 14px;
}

.panel h3 {
  margin: 5px 0;
  text-align: center;
  font-size: 16px;
}

.listItem {
  padding: 6px;
  margin-bottom: 4px;
  background: rgba(255,255,255,0.07);
  border-radius: var(--radius);
}

</style>
</head>

<body>

<div id="winnerBanner">Spin the wheel!</div>

<div class="controls">
  <button class="btn" onclick="startSpin('safety')">Spin Safety</button>
  <button class="btn" onclick="startSpin('tech')">Spin Tech</button>
  <button class="btn reset-btn" onclick="confirmReset()">Reset</button>
</div>

<div id="wheelContainer">
  <div id="pointer"></div>
  <div id="wheel"></div>
</div>

<div class="sidePanelContainer">
  <div class="panel">
    <h3>Remaining</h3>
    <div id="remainingList"></div>
  </div>

  <div class="panel">
    <h3>Selected</h3>
    <div id="chosenList"></div>
  </div>
</div>

<script>

/* ---------- DEFAULT ROSTER ---------- */
const defaultRoster = [
  "Ali Santiago","Anna Hutchinson","Austin Bartoszek","Brian Kloppe",
  "Casey Williams","Carter Nelson","Christian A. Johnston","Christie Walters",
  "Daniel Taggart","Emiliano Garcia","Frank Bottiglieri","Grace Frigaard",
  "Greg Waters","Ian Manhoo","Jim Pesek","Julissa Vergara",
  "Kevin Ferm","Kyle Young","Mark Besser","Patrick McCarron",
  "Rey Rodriguez","Richard Fredette","Shaun Thomas","Shane Bowen",
  "Stacie Gray","Steve Lauer","Timothy Costello"
];

/* ---------- SAFE LOADING FUNCTION ---------- */
function loadPool(key, fallback) {
  let saved = JSON.parse(localStorage.getItem(key));

  if (!Array.isArray(saved) || saved.length === 0) {
    localStorage.setItem(key, JSON.stringify([...fallback]));
    return [...fallback];
  }
  return saved;
}

/* ---------- LOAD POOLS SAFELY ---------- */
let names = loadPool("names", defaultRoster);
let safetyPool = loadPool("safetyPool", names);
let techPool = loadPool("techPool", names);
let chosenHistory = loadPool("chosenHistory", []);

/* ---------- SAVE ---------- */
function save() {
  localStorage.setItem("names", JSON.stringify(names));
  localStorage.setItem("safetyPool", JSON.stringify(safetyPool));
  localStorage.setItem("techPool", JSON.stringify(techPool));
  localStorage.setItem("chosenHistory", JSON.stringify(chosenHistory));
}

/* ---------- INITIALS ---------- */
function getInitials(name) {
  return name.split(" ").map(w => w[0]).join("").toUpperCase();
}

/* ---------- DRAW WHEEL ---------- */
function buildWheel(list) {
  const wheel = document.getElementById("wheel");
  wheel.innerHTML = "";

  const sliceAngle = 360 / list.length;
  let gradientParts = [];

  list.forEach((name, i) => {
    const start = i * sliceAngle;
    const end = start + sliceAngle;
    const color = i % 2 === 0 ? "var(--accent)" : "var(--accent2)";
    gradientParts.push(`${color} ${start}deg ${end}deg`);
  });

  wheel.style.background = `conic-gradient(${gradientParts.join(",")})`;

  list.forEach((name, i) => {
    const label = document.createElement("div");
    label.className = "sliceLabel";
    label.style.transform = `rotate(${sliceAngle * i}deg) translate(0, -50%)`;
    label.textContent = getInitials(name);
    wheel.appendChild(label);
  });
}

/* ---------- SPIN FUNCTION ---------- */
let spinning = false;

function startSpin(type) {
  if (spinning) return;
  spinning = true;

  let pool = type === "safety" ? safetyPool : techPool;
  if (pool.length === 0) pool = type === "safety" ? (safetyPool = [...names]) : (techPool = [...names]);

  buildWheel(pool);

  const wheel = document.getElementById("wheel");
  const sliceAngle = 360 / pool.length;

  const index = Math.floor(Math.random() * pool.length);
  const winner = pool[index];

  const endRotation = 360 * 12 + (360 - (index * sliceAngle + sliceAngle / 2));
  wheel.style.transform = `rotate(${endRotation}deg)`;

  setTimeout(() => {
    spinning = false;

    pool.splice(index, 1);
    chosenHistory.unshift(winner);
    save();

    document.getElementById("winnerBanner").innerHTML = `ðŸ† Congratulations, ${winner}!`;
    updateLists();
  }, 6000);
}

/* ---------- UPDATE LISTS ---------- */
function updateLists() {
  document.getElementById("remainingList").innerHTML =
    names.map(n => `<div class='listItem'>${n}</div>`).join("");

  document.getElementById("chosenList").innerHTML =
    chosenHistory.map(n => `<div class='listItem'>âœ” ${n}</div>`).join("");
}

/* ---------- RESET ---------- */
function confirmReset() {
  if (!confirm("Reset ALL progress?")) return;

  localStorage.clear();
  names = [...defaultRoster];
  safetyPool = [...defaultRoster];
  techPool = [...defaultRoster];
  chosenHistory = [];
  save();
  updateLists();
  buildWheel(names);
  document.getElementById("winnerBanner").textContent = "Progress Reset.";
}

/* ---------- INIT ---------- */
buildWheel(names);
updateLists();

</script>

</body>
</html>

