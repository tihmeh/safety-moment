<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Safety & Tech Share Wheel</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: row;
      height: 100vh;
      overflow: hidden;
    }

    .sidebar {
      width: 22%;
      background: #ffffff;
      padding: 20px;
      overflow-y: auto;
      border-right: 2px solid #ddd;
    }

    .sidebar-right {
      width: 22%;
      background: #ffffff;
      padding: 20px;
      overflow-y: auto;
      border-left: 2px solid #ddd;
    }

    .main {
      width: 56%;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 20px;
    }

    h2, h3 { margin-top: 0; text-align: center; }

    #wheel {
      margin-top: 20px;
      width: 350px;
      height: 350px;
      border: 10px solid #333;
      border-radius: 50%;
      position: relative;
      overflow: hidden;
      transform: rotate(0deg);
      transition: transform 6s cubic-bezier(.17,.67,.12,1.02);
    }

    .slice {
      position: absolute;
      width: 50%;
      height: 50%;
      top: 50%;
      left: 50%;
      transform-origin: 0% 0%;
      border: 1px solid #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      text-align: center;
      color: #000;
      padding: 3px;
    }

    #pointer {
      width: 0;
      height: 0;
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-bottom: 30px solid red;
      margin-top: 10px;
    }

    input {
      padding: 10px;
      font-size: 16px;
      width: 250px;
      margin-bottom: 10px;
    }

    .btn {
      padding: 10px 20px;
      margin: 5px;
      background: #0070f3;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }

    .btn:hover {
      background: #005ad1;
    }

    #result {
      margin-top: 20px;
      font-size: 22px;
      font-weight: bold;
      text-align: center;
      height: 60px;
    }
  </style>
</head>
<body>

  <div class="sidebar">
    <h3>Remaining People</h3>
    <div id="remainingList"></div>
  </div>

  <div class="main">

    <h2>Safety & Tech Share Wheel</h2>

    <input id="nameInput" placeholder="Add new name(s)">
    <button class="btn" onclick="addNames()">Add</button>

    <div>
      <button class="btn" onclick="startSpin('safety')">Spin Safety Moment</button>
      <button class="btn" onclick="startSpin('tech')">Spin Tech Share</button>
    </div>

    <div id="pointer"></div>
    <div id="wheel"></div>

    <div id="result"></div>
  </div>

  <div class="sidebar-right">
    <h3>Already Chosen</h3>
    <div id="chosenList"></div>
  </div>

  <script>
    const defaultRoster = [
      "Ali Santiago","Anna Hutchinson","Austin Bartoszek","Brian Kloppe",
      "Casey Williams","Carter Nelson","Christian A. Johnston","Christie Walters",
      "Daniel Taggart","Emiliano Garcia","Frank Bottiglieri","Grace Frigaard",
      "Greg Waters","Ian Manhoo","Jim Pesek","Julissa Vergara",
      "Kevin Ferm","Kyle Young","Mark Besser",
      "Patrick McCarron","Rey Rodriguez","Richard Fredette","Shaun Thomas",
      "Shane Bowen","Stacie Gray","Steve Lauer","Timothy Costello"
    ];

    let names = JSON.parse(localStorage.getItem("names"));
    let remainingSafety = JSON.parse(localStorage.getItem("remainingSafety"));
    let remainingTech = JSON.parse(localStorage.getItem("remainingTech"));
    let chosenHistory = JSON.parse(localStorage.getItem("chosenHistory"));

    if (!names) {
      names = [...defaultRoster];
      remainingSafety = [...defaultRoster];
      remainingTech = [...defaultRoster];
      chosenHistory = [];
      save();
    }

    function save() {
      localStorage.setItem("names", JSON.stringify(names));
      localStorage.setItem("remainingSafety", JSON.stringify(remainingSafety));
      localStorage.setItem("remainingTech", JSON.stringify(remainingTech));
      localStorage.setItem("chosenHistory", JSON.stringify(chosenHistory));
    }

    function addNames() {
      let input = document.getElementById("nameInput").value.trim();
      if (!input) return;

      let newNames = input.split(",").map(n => n.trim()).filter(n => n.length > 0);

      newNames.forEach(n => {
        if (!names.includes(n)) {
          names.push(n);
          remainingSafety.push(n);
          remainingTech.push(n);
        }
      });

      save();
      document.getElementById("nameInput").value = "";
      updateLists();
      buildWheel();
    }

    let spinning = false;

    function buildWheel(list = names) {
      const wheel = document.getElementById("wheel");
      wheel.innerHTML = "";
      const sliceAngle = 360 / list.length;

      list.forEach((name, i) => {
        const slice = document.createElement("div");
        slice.className = "slice";
        slice.style.transform = `rotate(${sliceAngle * i}deg) skewY(${90 - sliceAngle}deg)`;
        slice.style.background = i % 2 === 0 ? "#7cc6fe" : "#4da3ff";
        slice.innerHTML = `
          <div style="transform: skewY(-${90 - sliceAngle}deg) rotate(${sliceAngle / 2}deg)">
            ${name}
          </div>`;
        wheel.appendChild(slice);
      });
    }

    function startSpin(type) {
      if (spinning) return;

      let pool = type === "safety" ? remainingSafety : remainingTech;

      if (pool.length === 0) {
        alert("Everyone has gone! Resetting list.");
        pool = type === "safety"
          ? (remainingSafety = [...names])
          : (remainingTech = [...names]);
      }

      buildWheel(pool);

      spinning = true;
      const wheel = document.getElementById("wheel");

      const index = Math.floor(Math.random() * pool.length);
      const winner = pool[index];
      const sliceAngle = 360 / pool.length;

      const finalRotation =
        360 * 8 + (360 - (index * sliceAngle + sliceAngle / 2));

      wheel.style.transform = `rotate(${finalRotation}deg)`;

      setTimeout(() => {
        spinning = false;

        pool.splice(index, 1);
        chosenHistory.push(winner);
        save();

        document.getElementById("result").innerHTML =
          `${type === "safety" ? "Safety Moment:" : "Tech Share:"}<br><br>ðŸŽ‰ ${winner}`;

        updateLists();
      }, 6000);
    }

    function updateLists() {
      document.getElementById("remainingList").innerHTML =
        names.map(n => `<div>${n}</div>`).join("");

      document.getElementById("chosenList").innerHTML =
        chosenHistory.map(n => `<div>âœ” ${n}</div>`).join("");
    }

    buildWheel(names);
    updateLists();
  </script>

</body>
</html>
