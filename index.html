<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Safety & Tech Share Wheel ‚Äî Pointer Aligned</title>

<style>
body {
    margin: 0;
    background: #111;
    color: white;
    font-family: Arial, sans-serif;
    height: 100vh;
    overflow: hidden;
    display: grid;
    grid-template-columns: 250px 1fr 250px;
    grid-template-rows: auto 1fr;
    grid-template-areas:
        "header header header"
        "left wheel right";
}

/* HEADER */
#header {
    grid-area: header;
    text-align: center;
    padding: 10px;
}

#winnerBanner {
    font-size: 24px;
    padding: 12px;
    margin: 10px auto;
    width: 60%;
    background: #333;
    border-radius: 10px;
    transition: transform .3s ease;
}

/* PANELS */
#leftPanel, #rightPanel {
    background: #1a1a1a;
    padding: 10px;
    overflow-y: auto;
}
#leftPanel { grid-area: left; border-right: 2px solid #333; }
#rightPanel { grid-area: right; border-left: 2px solid #333; }

.panelTitle {
    font-size: 20px;
    margin-bottom: 10px;
    text-align: center;
}

.listItem {
    padding: 6px;
    background: #222;
    margin-bottom: 6px;
    border-radius: 6px;
}

/* WHEEL AREA */
#wheelArea {
    grid-area: wheel;
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
}

#wheelWrapper {
    position: relative;
}

/* RIGHT SIDE POINTER */
#pointer {
    position: absolute;
    right: -20px;
    top: 50%;
    transform: translateY(-50%);
    width: 0;
    height: 0;
    border-top: 20px solid transparent;
    border-bottom: 20px solid transparent;
    border-left: 35px solid red;
    z-index: 10;
}

#wheel {
    width: 400px;
    height: 400px;
    border-radius: 50%;
    border: 6px solid #444;
    background: conic-gradient(
        #00eaff 0deg 30deg, #ff4da6 30deg 60deg,
        #00eaff 60deg 90deg, #ff4da6 90deg 120deg,
        #00eaff 120deg 150deg, #ff4da6 150deg 180deg,
        #00eaff 180deg 210deg, #ff4da6 210deg 240deg,
        #00eaff 240deg 270deg, #ff4da6 270deg 300deg,
        #00eaff 300deg 330deg, #ff4da6 330deg 360deg
    );
    position: relative;
    overflow: hidden;
    transition: transform 5s cubic-bezier(.17,.67,.12,1.02);
}

.sliceLabel {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 43%;
    transform-origin: 0% 50%;
    font-size: 18px;
    text-align: right;
    pointer-events: none;
    color: white;
}

/* Buttons */
button {
    padding: 12px 20px;
    margin: 5px;
    border-radius: 6px;
    background: #007bff;
    border: none;
    color: white;
    cursor: pointer;
}
button:hover { background: #0056b3; }
.reset-btn { background: #ff4444; }

/* Confetti */
.confetti {
    position: fixed;
    width: 12px;
    height: 12px;
    top: -10px;
    opacity: 0.9;
    animation: confettiFall 2.5s linear forwards;
    z-index: 999999;
}
@keyframes confettiFall {
    to { transform: translateY(110vh) rotate(720deg); }
}
</style>
</head>

<body>

<!-- HEADER -->
<div id="header">
    <h1>Safety & Tech Share Wheel</h1>
    <div id="winnerBanner">Spin the wheel!</div>
    <button onclick="spin('safety')">Spin Safety</button>
    <button onclick="spin('tech')">Spin Tech</button>
    <button class="reset-btn" onclick="resetAll()">Reset</button>
</div>

<!-- LEFT PANEL -->
<div id="leftPanel">
    <div class="panelTitle">Remaining</div>
    <div id="remainingList"></div>
</div>

<!-- WHEEL AREA -->
<div id="wheelArea">
    <div id="wheelWrapper">
        <div id="pointer"></div>
        <div id="wheel"></div>
    </div>
</div>

<!-- RIGHT PANEL -->
<div id="rightPanel">
    <div class="panelTitle">Selected</div>
    <div id="chosenList"></div>
</div>

<script>

/* ------------ DATA ------------ */
const defaultRoster = [
  "Ali Santiago","Anna Hutchinson","Austin Bartoszek","Brian Kloppe",
  "Casey Williams","Carter Nelson","Christian A. Johnston","Christie Walters",
  "Daniel Taggart","Emiliano Garcia","Frank Bottiglieri","Grace Frigaard",
  "Greg Waters","Ian Manhoo","Jim Pesek","Julissa Vergara",
  "Kevin Ferm","Kyle Young","Mark Besser","Patrick McCarron",
  "Rey Rodriguez","Richard Fredette","Shaun Thomas","Shane Bowen",
  "Stacie Gray","Steve Lauer","Timothy Costello"
];

function load(key, fallback) {
    let x = JSON.parse(localStorage.getItem(key));
    return Array.isArray(x) && x.length ? x : [...fallback];
}

let names = load("names", defaultRoster);
let safetyPool = load("safetyPool", names);
let techPool = load("techPool", names);
let chosenHistory = load("chosenHistory", []);

function save() {
    localStorage.setItem("names", JSON.stringify(names));
    localStorage.setItem("safetyPool", JSON.stringify(safetyPool));
    localStorage.setItem("techPool", JSON.stringify(techPool));
    localStorage.setItem("chosenHistory", JSON.stringify(chosenHistory));
}

/* ------------ INITIALS ------------ */
const initials = name => name.split(" ").map(w => w[0]).join("").toUpperCase();

/* ------------ WHEEL BUILD ------------ */
function buildWheel(pool) {
    const wheel = document.getElementById("wheel");
    wheel.innerHTML = "";
    const angle = 360 / pool.length;

    for (let i = 0; i < pool.length; i++) {
        const d = document.createElement("div");
        d.className = "sliceLabel";
        d.textContent = initials(pool[i]);
        d.style.transform = `rotate(${angle * i}deg) translate(0, -50%)`;
        wheel.appendChild(d);
    }
}

/* ------------ CONFETTI ------------ */
function confetti() {
    for (let i = 0; i < 40; i++) {
        const c = document.createElement("div");
        c.className = "confetti";
        c.style.left = Math.random()*100 + "vw";
        c.style.background = ["#ff4da6","#00eaff","#8a2eff","#ffdd00"]
            [Math.floor(Math.random()*4)];
        document.body.appendChild(c);
        setTimeout(() => c.remove(), 3000);
    }
}

/* ------------ SPIN (RIGHT-ALIGNED POINTER FIX) ------------ */
let spinning = false;

function spin(type) {
    if (spinning) return;
    spinning = true;

    let pool = (type === "safety") ? safetyPool : techPool;

    if (pool.length === 0) {
        pool = type === "safety" ? (safetyPool = [...names]) : (techPool = [...names]);
    }

    buildWheel(pool);

    const wheel = document.getElementById("wheel");
    const sliceAngle = 360 / pool.length;
    const index = Math.floor(Math.random() * pool.length);
    const winner = pool[index];

    /* RESET */
    wheel.style.transition = "none";
    wheel.style.transform = "rotate(0deg)";
    wheel.offsetHeight;

    /* 
       RIGHT-SIDE POINTER ALIGNMENT FIX:
       Pointer is at 90¬∞, so we subtract 90¬∞ from the slice center 
       to align perfectly on the pointer.
    */
    let landingAngle = (index * sliceAngle + sliceAngle / 2) - 90;

    // normalize 
    landingAngle = ((landingAngle % 360) + 360) + 360 * 10;

    wheel.style.transition = "transform 5s cubic-bezier(.17,.67,.12,1.02)";
    wheel.style.transform = `rotate(${landingAngle}deg)`;

    setTimeout(() => {
        spinning = false;

        pool.splice(index, 1);
        chosenHistory.unshift(winner);
        save();

        const banner = document.getElementById("winnerBanner");
        banner.innerHTML = `üéâüèÜ Congratulations, <strong>${winner}</strong>!`;
        banner.style.transform = "scale(1.2)";
        setTimeout(()=>banner.style.transform="scale(1)", 300);

        confetti();
        updateLists();
    }, 5100);
}

/* ------------ UPDATE LISTS ------------ */
function updateLists() {
    document.getElementById("remainingList").innerHTML =
        names.map(n=>`<div class='listItem'>${n}</div>`).join("");

    document.getElementById("chosenList").innerHTML =
        chosenHistory.map(n=>`<div class='listItem'>‚úî ${n}</div>`).join("");
}

/* ------------ RESET ------------ */
function resetAll() {
    if (!confirm("Reset ALL progress?")) return;
    localStorage.clear();
    names=[...defaultRoster];
    safetyPool=[...defaultRoster];
    techPool=[...defaultRoster];
    chosenHistory=[];
    save();
    buildWheel(names);
    updateLists();
    document.getElementById("winnerBanner").textContent="Progress Reset.";
}

/* ------------ INIT ------------ */
buildWheel(names);
updateLists();

</script>
</body>
</html>
