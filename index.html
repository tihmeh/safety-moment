<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Safety & Tech Share Wheel ‚Äî Working Version</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #111;
    color: white;
    text-align: center;
    margin: 0;
    padding: 20px;
}

h1 { margin-bottom: 10px; }

/* Winner Banner */
#winnerBanner {
    font-size: 26px;
    margin: 15px;
    padding: 15px;
    background: #333;
    border-radius: 10px;
    transition: transform 0.3s ease;
}

/* Buttons */
button {
    padding: 12px 20px;
    margin: 10px;
    background: #007bff;
    border: none;
    border-radius: 6px;
    color: white;
    cursor: pointer;
    font-size: 16px;
}
button:hover { background: #0056b3; }
.reset-btn { background: #ff4444 !important; }

/* Pointer */
#pointer {
    width: 0;
    height: 0;
    border-left: 20px solid transparent;
    border-right: 20px solid transparent;
    border-bottom: 30px solid red;
    margin: 10px auto;
}

/* Wheel */
#wheel {
    width: 350px;
    height: 350px;
    border-radius: 50%;
    border: 6px solid #444;
    margin: 20px auto;
    position: relative;
    overflow: hidden;
    transition: transform 5s cubic-bezier(.17,.67,.12,1.02);
    background: conic-gradient(
        #00eaff 0deg 30deg, #ff4da6 30deg 60deg,
        #00eaff 60deg 90deg, #ff4da6 90deg 120deg,
        #00eaff 120deg 150deg, #ff4da6 150deg 180deg,
        #00eaff 180deg 210deg, #ff4da6 210deg 240deg,
        #00eaff 240deg 270deg, #ff4da6 270deg 300deg,
        #00eaff 300deg 330deg, #ff4da6 330deg 360deg
    );
}

.sliceLabel {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 40%;
    transform-origin: 0% 50%;
    color: white;
    font-size: 18px;
    font-weight: bold;
    pointer-events: none;
    text-align: right;
}

/* Panels */
.panel {
    width: 300px;
    margin: 20px auto;
    padding: 15px;
    background: #222;
    border-radius: 10px;
}
.listItem { padding: 6px; }

/* Confetti */
.confetti {
    position: fixed;
    width: 12px;
    height: 12px;
    top: -10px;
    opacity: 0.9;
    animation: fallConfetti 2.5s linear forwards;
    z-index: 9999;
}
@keyframes fallConfetti {
    to { transform: translateY(110vh) rotate(720deg); }
}
</style>
</head>

<body>

<h1>Safety & Tech Share Wheel</h1>

<div id="winnerBanner">Spin the wheel!</div>

<button onclick="spin('safety')">Spin Safety</button>
<button onclick="spin('tech')">Spin Tech</button>
<button class="reset-btn" onclick="resetAll()">Reset</button>

<div id="pointer"></div>
<div id="wheel"></div>

<div class="panel">
    <h3>Remaining People</h3>
    <div id="remainingList"></div>
</div>

<div class="panel">
    <h3>Selected</h3>
    <div id="chosenList"></div>
</div>

<script>

/* ------------------ DATA ------------------ */
const defaultRoster = [
  "Ali Santiago","Anna Hutchinson","Austin Bartoszek","Brian Kloppe",
  "Casey Williams","Carter Nelson","Christian A. Johnston","Christie Walters",
  "Daniel Taggart","Emiliano Garcia","Frank Bottiglieri","Grace Frigaard",
  "Greg Waters","Ian Manhoo","Jim Pesek","Julissa Vergara",
  "Kevin Ferm","Kyle Young","Mark Besser","Patrick McCarron",
  "Rey Rodriguez","Richard Fredette","Shaun Thomas","Shane Bowen",
  "Stacie Gray","Steve Lauer","Timothy Costello"
];

function load(key, fallback) {
    let x = JSON.parse(localStorage.getItem(key));
    return Array.isArray(x) && x.length ? x : [...fallback];
}

let names = load("names", defaultRoster);
let safetyPool = load("safetyPool", names);
let techPool = load("techPool", names);
let chosenHistory = load("chosenHistory", []);

function save() {
    localStorage.setItem("names", JSON.stringify(names));
    localStorage.setItem("safetyPool", JSON.stringify(safetyPool));
    localStorage.setItem("techPool", JSON.stringify(techPool));
    localStorage.setItem("chosenHistory", JSON.stringify(chosenHistory));
}

/* ------------------ INITIALS ------------------ */
const initials = name => name.split(" ").map(w => w[0]).join("").toUpperCase();

/* ------------------ WHEEL BUILD ------------------ */
function buildWheel(pool) {
    const wheel = document.getElementById("wheel");
    wheel.innerHTML = "";
    const angle = 360 / pool.length;

    for (let i = 0; i < pool.length; i++) {
        const div = document.createElement("div");
        div.className = "sliceLabel";
        div.textContent = initials(pool[i]);
        div.style.transform = `rotate(${i * angle}deg) translate(0, -50%)`;
        wheel.appendChild(div);
    }
}

/* ------------------ CONFETTI ------------------ */
function launchConfetti() {
    for (let i = 0; i < 50; i++) {
        const c = document.createElement("div");
        c.className = "confetti";
        c.style.left = Math.random() * 100 + "vw";
        c.style.background = ["#ff4da6","#00eaff","#8a2eff","#ffdd00"]
            [Math.floor(Math.random()*4)];
        c.style.animationDuration = (1.5 + Math.random() * 1.5) + "s";
        document.body.appendChild(c);
        setTimeout(() => c.remove(), 3000);
    }
}

/* ------------------ SPIN ------------------ */
let spinning = false;

function spin(type) {
    if (spinning) return;
    spinning = true;

    let pool = type === "safety" ? safetyPool : techPool;
    if (pool.length === 0) pool = type === "safety" ? (safetyPool=[...names]) : (techPool=[...names]);

    buildWheel(pool);

    const wheel = document.getElementById("wheel");
    const angle = 360 / pool.length;
    const index = Math.floor(Math.random() * pool.length);
    const winner = pool[index];

    // Reset -> force reflow -> spin
    wheel.style.transition = "none";
    wheel.style.transform = "rotate(0deg)";
    wheel.offsetHeight;

    const finalAngle = 360 * 10 + (360 - (index * angle + angle / 2));
    wheel.style.transition = "transform 5s cubic-bezier(.17,.67,.12,1.02)";
    wheel.style.transform = `rotate(${finalAngle}deg)`;

    setTimeout(() => {
        spinning = false;
        pool.splice(index, 1);
        chosenHistory.unshift(winner);
        save();

        // Winner Banner Animation
        const banner = document.getElementById("winnerBanner");
        banner.innerHTML = `üéâüèÜ Congratulations, <strong>${winner}</strong>! üèÜüéâ`;
        banner.style.transform = "scale(1.15)";
        setTimeout(() => banner.style.transform = "scale(1)", 300);

        launchConfetti();
        updateLists();

    }, 5100);
}

/* ------------------ UPDATE LISTS ------------------ */
function updateLists() {
    document.getElementById("remainingList").innerHTML =
        names.map(n => `<div class='listItem'>${n}</div>`).join("");

    document.getElementById("chosenList").innerHTML =
        chosenHistory.map(n => `<div class='listItem'>‚úî ${n}</div>`).join("");
}

/* ------------------ RESET ------------------ */
function resetAll() {
    if (!confirm("Reset ALL progress?")) return;

    localStorage.clear();
    names = [...defaultRoster];
    safetyPool = [...defaultRoster];
    techPool = [...defaultRoster];
    chosenHistory = [];
    save();

    buildWheel(names);
    updateLists();
    document.getElementById("winnerBanner").textContent = "Progress Reset.";
}

/* ------------------ INIT ------------------ */
buildWheel(names);
updateLists();

</script>

</body>
</html>
